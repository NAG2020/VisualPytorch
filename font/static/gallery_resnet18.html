<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <title>蚂蚁/蜜蜂二分类（ResNet-18）</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <!-- ================== BEGIN BASE CSS STYLE ================== -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet"/>
    <link href="../resources/assets/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet"/>
    <link href="../resources/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="../resources/assets/plugins/font-awesome/css/all.min.css" rel="stylesheet"/>
    <link href="../resources/assets/plugins/animate/animate.min.css" rel="stylesheet"/>
    <link href="../resources/assets/css/default/style.min.css" rel="stylesheet"/>
    <link href="../resources/assets/css/default/style-responsive.min.css" rel="stylesheet"/>
    <link href="../resources/assets/css/default/theme/default.css" rel="stylesheet" id="theme1"/>
    <!-- ================== END BASE CSS STYLE ================== -->

    <!-- ================== BEGIN PAGE LEVEL CSS STYLE ================== -->
    <link href="../resources/assets/plugins/superbox/css/superbox.css" rel="stylesheet" id="theme"/>
    <link href="../resources/assets/plugins/dropzone/min/dropzone.min.css" rel="stylesheet"/>
    <!-- ================== END PAGE LEVEL CSS STYLE ================== -->

    <!-- ================== BEGIN BASE JS ================== -->
    <script src="../resources/assets/plugins/pace/pace.min.js"></script>
    <script type="text/javascript" src="../javascript/base_service.js"></script>
    <!-- ================== END BASE JS ================== -->
</head>
<body>
<!-- begin #page-loader -->
<div id="page-loader" class="fade show"><span class="spinner"></span></div>
<!-- end #page-loader -->

<!-- begin #page-container -->
<div id="page-container" class="fade page-sidebar-fixed page-header-fixed">
    <!-- begin #sidebar -->
    <div id="sidebar" class="sidebar">
        <!-- begin sidebar scrollbar -->
        <div data-scrollbar="true" data-height="100%">
            <!-- begin sidebar user -->
            <ul class="nav">
                <li class="nav-profile">
                    <a href="javascript:;" data-toggle="nav-profile">
                        <div class="cover with-shadow"></div>
                        <div class="image">
                            <img src="../resources/templatesRes/img/favicon.ico" alt=""/>
                        </div>
                        <div class="info">
                            <b class="caret pull-right"></b>
                            VisualPytorch
                            <small>2020北航软工课设</small>
                        </div>
                    </a>
                </li>
            </ul>
            <!-- end sidebar user -->
            <!-- begin sidebar nav -->
            <ul class="nav">
                <li class="nav-header"><a href="index.html">返回首页</a></li>
                <li class="has-sub active">
                    <a href="javascript:;">
                        <b class="caret"></b>
                        <i class="fa fa-image"></i>
                        <span>Inference样例</span>
                    </a>
                    <ul class="sub-menu">
                        <li class="active"><a href="gallery_resnet18.html">蚂蚁/蜜蜂图像二分类(ResNet-18)</a></li>
                        <li ><a href="gallery_dcgan.html">人脸图像生成（DCGAN）</a></li>
                        <li><a href="gallery_fastrcnn.html">目标探测（faster RCNN）</a></li>
                        <li><a href="gallery_unet.html">人像分割（Unet）</a></li>
                        <li><a href="gallery_resnet101.html">语义分割（ResNet-101）</a></li>
                    </ul>
                </li>
                <!-- begin sidebar minify button -->
                <li><a href="javascript:;" class="sidebar-minify-btn" data-click="sidebar-minify"><i
                        class="fa fa-angle-double-left"></i></a></li>
                <!-- end sidebar minify button -->
            </ul>
            <!-- end sidebar nav -->
        </div>
        <!-- end sidebar scrollbar -->
    </div>
    <div class="sidebar-bg"></div>
    <!-- end #sidebar -->
    <!-- begin #content -->
    <div id="content" class="content">
        <!-- begin breadcrumb -->
        <ol class="breadcrumb pull-right">
            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
            <li class="breadcrumb-item"><a href="gallery_resnet18.html">ResNet-18</a></li>
        </ol>
        <!-- end breadcrumb -->
        <!-- begin page-header -->
        <h1 class="page-header">图像分类 <small style="color:black;font-size: 18px">基于ResNet-18，<a href="https://baidu.com">查看模型架构</a></small>
        </h1>
        <!-- end page-header -->
        <!-- begin superbox -->

        <div class="superbox " data-offset="50">
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/ant1.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/ant1-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/ant1.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/ant2.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/ant2-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/ant2.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/ant3.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/ant3-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/ant3.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/ant4.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/ant4-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/ant4.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/ant5.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/ant5-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/ant5.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/bee1.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/bee1-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/bee1.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/bee2.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/bee2-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/bee2.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/bee3.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/bee3-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/bee3.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/bee4.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/bee4-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/bee4.jpg);"></span>
                </a>
            </div>
            <div class="superbox-list">
                <a href="javascript:;" class="superbox-img">
                    <img data-img="../resources/assets/img/gallery/bee5.jpg"
                         data-desc="<img class=img-pridict src=../resources/assets/img/gallery/bee5-pridict.png>"/>
                    <span style="background: url(../resources/assets/img/gallery/bee5.jpg);"></span>
                </a>
            </div>


        </div>
        <!-- end superbox -->
    </div>
    <!-- end #content -->


    <!-- begin scroll to top btn -->
    <a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i
            class="fa fa-angle-up"></i></a>
    <!-- end scroll to top btn -->
</div>
<!-- begin panel -->
<div class="panel panel-inverse" data-sortable-id="form-dropzone-1">
    <div class="panel-heading">
        <div class="panel-heading-btn">
            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i
                    class="fa fa-expand"></i></a>
            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i
                    class="fa fa-minus"></i></a>
            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i
                    class="fa fa-times"></i></a>
        </div>
        <h4 class="panel-title">上传图像文件</h4>
    </div>
    <div class="panel-body text-inverse">
        <input type="file" id="photoFile" style="display: none;" onchange="upload()">
        <button class="btn btn-primary" onclick="uploadPhoto()">选择图片</button>
        <span class="help-block ">请尝试上传<strong>5M</strong>以内的<strong>蜜蜂</strong>或<strong>蚂蚁</strong>图片！</span>
        <div class="row">
            <div class="col-md-5">
                <img id="preview_photo" src="" style="display: none">
            </div>
            <div id="result" class="alert alert-primary fade show col-md-6" style="display: none">
                <span class="close" data-dismiss="alert">×</span>
                <strong>Success!</strong>
                <br/>
                <p id="result-text"></p>

            </div>
        </div>
        <script>
            function uploadPhoto() {
                $("#photoFile").click();
            }

            /**
             * 上传图片
             */

            function upload() {
                var filepath = $("#photoFile").val();
                //检查是否为图片
                if (!isImage(filepath)) {
                    return false;
                }
                //检查文件大小，不能超过2M
                if (!checkFileSize(filepath)) {
                    return false;
                }
                if ($("#photoFile").val() == '') {
                    return;
                }
                var formData = new FormData();
                formData.append('pic', document.getElementById('photoFile').files[0]);
                $.ajax({
                    url: "http://127.0.0.1:8000/api/inference/resnet18/",
                    type: "post",
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        $("#preview_photo").attr("style", "float: left;width:400px;height:400px;");
                        $("#preview_photo").attr("src", data["addr"]);
                        $("#result").attr("style", "float: right;height:400px");
                        $("#result-text").replaceWith("<p>" + "<b>Input Img Shape:</b>[" + data["input_shape"] + "]<br/>"
                            + "<b>Infernce Time:</b>" + data["time"] + "s"
                            + "</p>");
                    },
                    error: function (data) {
                        alert("上传失败")
                    }
                });
            }
        </script>
    </div>
</div>
<!-- end panel -->
<!-- begin panel -->
<div class="panel panel-inverse" data-sortable-id="ui-typography-13">
    <div class="panel-heading">
        <div class="panel-heading-btn">
            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i
                    class="fa fa-expand"></i></a>
            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i
                    class="fa fa-minus"></i></a>
            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i
                    class="fa fa-times"></i></a>
        </div>
        <h4 class="panel-title">ResNet-18图像分类简介</h4>
    </div>
    <div class="panel-body">
        <dl>
<div  id='write'  class = 'is-node'><h4><a name="图像分类resnet18）简介" class="md-header-anchor"></a><span>图像分类（resnet18）简介</span></h4><p><span>问题描述：使用图像分类经典模型resnet18进行蜜蜂/蚂蚁图像分类。</span></p><h5><a name="模型如何完成图像分类" class="md-header-anchor"></a><span>模型如何完成图像分类？</span></h5><p><img src="https://img2020.cnblogs.com/blog/1972898/202005/1972898-20200519093845763-391328764.png" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>Resnet在2015年由</span><a href='(https://blog.csdn.net/csdnldp/article/details/78313087)'><span>《Deep Residual Learning for Image Recognition》</span></a><span>提出， 网上有大量的文章讲解其原理和思路，简单来说，resnet巧妙地利用了shortcut连接，解决了深度网络中模型退化的问题。下面是不同层数resnet的网络结构：</span></p><p><img src="https://img2020.cnblogs.com/blog/1972898/202005/1972898-20200516231052540-105631160.png" style="zoom:50%;" /></p><p><span>下图展示了18层resnet与50层resnet结构对比：</span></p><p><img src="https://upload-images.jianshu.io/upload_images/15074510-9020942365d29220.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img" style="zoom:50%;" /></p><h5><a name="推理基本步骤" class="md-header-anchor"></a><span>推理基本步骤：</span></h5><ol start='' ><li><span>获取数据与模型</span></li><li><span>数据变换，如RGB → 4D-Tensor</span></li><li><span>前向传播</span></li><li><span>输出保存预测结果</span></li></ol><h5><a name="inference阶段注意事项" class="md-header-anchor"></a><span>Inference阶段注意事项：</span></h5><ol start='' ><li><span>确保 model处于eval状态而非training</span></li><li><span>设置torch.no_grad()，减少内存消耗</span></li><li><span>数据预处理需保持一致，RGB o rBGR？</span></li></ol><p><span>输入：任意大小图片（含有蜜蜂或蚂蚁）</span></p><p><span>输出：分类图像+描述（包括输入尺寸，时间）</span></p><h5><a name="样例描述" class="md-header-anchor"></a><span>样例描述：</span></h5><p><span>ant1-ant5均为蚂蚁图像，bee1-bee5为蜜蜂图像。其中ant5被错分为蜜蜂，可能因为背景是花，同样bee5也被错分，由此可见，我们使用resnet18训练出来的模型的分类有点依赖背景而非主体。</span></p></div>


        </dl>
    </div>
</div>
<!-- end panel -->

<!-- end page container -->

<!-- ================== BEGIN BASE JS ================== -->
<script src="../resources/assets/plugins/jquery/jquery-3.3.1.min.js"></script>
<script src="../resources/assets/plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="../resources/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!--[if lt IE 9]>
<script src="../resources/assets/crossbrowserjs/html5shiv.js"></script>
<script src="../resources/assets/crossbrowserjs/respond.min.js"></script>
<script src="../resources/assets/crossbrowserjs/excanvas.min.js"></script>
<![endif]-->
<script src="../resources/assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<script src="../resources/assets/plugins/js-cookie/js.cookie.js"></script>
<script src="../resources/assets/js/theme/default.min.js"></script>
<script src="../resources/assets/js/apps.min.js"></script>
<!-- ================== END BASE JS ================== -->

<!-- ================== BEGIN PAGE LEVEL JS ================== -->
<script src="../resources/assets/plugins/superbox/js/jquery.superbox.js"></script>
<script src="../resources/assets/js/demo/gallery-v2.demo.min.js"></script>
<script src="../resources/assets/plugins/dropzone/min/dropzone.min.js"></script>
<script src="../resources/assets/plugins/highlight/highlight.common.js"></script>
<script src="../resources/assets/js/demo/render.highlight.js"></script>
<!-- ================== END PAGE LEVEL JS ================== -->

<script>
    $(document).ready(function () {
        App.init();
        GalleryV2.init();
        Highlight.init();
    });
</script>
</body>
</html>
